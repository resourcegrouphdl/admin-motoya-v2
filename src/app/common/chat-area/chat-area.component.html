<div class="relative">
  <!-- Chat Area -->
  <div class="flex-1 flex flex-col perspective-card">
    <div class="card-3d flex flex-col h-full">
      <!-- Chat Header -->
      <div class="p-4 border-b border-gray-700 glass-effect">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <img
              [src]="tiendaData?.imagen"
              alt="Sarah"
              class="w-10 h-10 rounded-full floating"
            />
            <div>
              <h3 class="font-semibold text-white">
                {{ tiendaData?.razonSocial }}
              </h3>
              <p class="text-sm text-green-400">online</p>
            </div>
          </div>
          <div class="flex items-center space-x-4">
            <button
              class="p-2 hover:bg-gray-700 rounded-full transition-colors"
            >
              <i class="fas fa-video text-gray-400 hover:text-white"></i>
            </button>
            <button
              class="p-2 hover:bg-gray-700 rounded-full transition-colors"
            >
              <i class="fas fa-phone text-gray-400 hover:text-white"></i>
            </button>
            <button
              class="p-2 hover:bg-gray-700 rounded-full transition-colors"
            >
              <i class="fas fa-ellipsis-v text-gray-400 hover:text-white"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Messages Area -->
      <div
        class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar"
        id="messagesArea"
      >
        <!-- Received Message -->
        <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar" id="messagesArea">
  <div *ngFor="let msg of mensajes" class="flex w-full" [ngClass]="msg.remitenteID === adminuid ? 'justify-end' : 'justify-start'">
    
    <!-- Mensaje del otro usuario -->
    <ng-container *ngIf="msg.remitenteID !== uidUsuario">
      <div class="flex items-start space-x-2">
        <img [src]="usuario?.imagen || defaultAvatar" class="w-8 h-8 rounded-full" alt="avatar" />
        <div class="max-w-xs lg:max-w-md">
          <div class="bg-gray-700 rounded-2xl rounded-tl-sm p-3 shadow-lg">
            <p class="text-white">{{ msg.contenido }}</p>
          </div>
          <p class="text-xs text-gray-400 mt-1 ml-2">
            {{ msg.timestamp?.toDate() }}
          </p>
        </div>
      </div>
    </ng-container>

    <!-- Mensaje del administrador -->
    <ng-container *ngIf="msg.remitenteID === uidUsuario">
      <div class="flex items-start justify-end space-x-2">
        <div class="bg-blue-500 text-white p-3 rounded-2xl rounded-tr-sm shadow-lg max-w-xs lg:max-w-md">
          <p>{{ msg.contenido }}</p>
          <p class="text-xs text-gray-200 mt-1 text-right">
            {{ msg.timestamp?.toDate()  }}
          </p>
        </div>
      </div>
    </ng-container>

  </div>
</div>

        <!-- Message Input -->

        <!-- Input para escribir mensajes -->
        <div
          class="p-4 border-t border-gray-700 glass-effect fixed bottom-0 w-9/12"
        >
          <div class="flex items-center space-x-3">
            <button
              class="p-2 hover:bg-gray-700 rounded-full transition-colors"
            >
              <i class="fas fa-paperclip text-gray-400 hover:text-white"></i>
            </button>

            <div class="flex-1 relative">
              <input
                [(ngModel)]="newMessage"
                type="text"
                placeholder="Escribe un mensaje..."
                class="w-full bg-gray-700 text-white placeholder-gray-400 rounded-full pl-4 pr-12 py-3 focus:outline-none focus:ring-2 focus:ring-green-400 transition-all"
                id="messageInput"
                (keydown.enter)="enviarMensaje()"
              />
              <button
                class="absolute right-2 top-1/2 transform -translate-y-1/2 p-2 hover:bg-gray-600 rounded-full transition-colors"
                title="Emoji"
              >
                <i class="fas fa-smile text-gray-400 hover:text-yellow-400"></i>
              </button>
            </div>

            <button
              (click)="enviarMensaje()"
              class="p-3 chat-gradient rounded-full hover:scale-105 transition-transform shadow-lg"
            >
              <i class="fas fa-paper-plane text-white"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
